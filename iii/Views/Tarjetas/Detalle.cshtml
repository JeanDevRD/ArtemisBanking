@model ArtemisBanking.Core.Application.Dtos.CreditCard.CreditCardDto
@{
    ViewData["Title"] = "Detalle de Tarjeta";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-8">
            <h3>Detalle de Tarjeta de Crédito</h3>
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong>Número de Tarjeta:</strong> ****@Model.CardNumber.Substring(Model.CardNumber.Length - 4)</p>
                            <p><strong>Límite de Crédito:</strong> <span class="h5">@Model.CreditLimit.ToString("C2")</span></p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Deuda Actual:</strong> <span class="h5 text-danger">@Model.CurrentDebt.ToString("C2")</span></p>
                            <p><strong>Crédito Disponible:</strong> <span class="h5 text-success">@(Model.CreditLimit - Model.CurrentDebt).ToString("C2")</span></p>
                        </div>
                    </div>
                    <hr />
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong>Fecha de Vencimiento:</strong> @Model.ExpirationDate.ToString("MM/yyyy")</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Estado:</strong> <span class="badge bg-@(Model.IsActive ? "success" : "danger")">@(Model.IsActive ? "Activa" : "Inactiva")</span></p>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>Pago Mínimo Sugerido:</strong> @(Model.CurrentDebt * 0.05m).ToString("C2")
                    </div>
                </div>
            </div>

            <div class="mt-4">
                <h5>Operaciones Disponibles</h5>
                <div class="btn-group" role="group">
                    <a asp-controller="Tarjetas" asp-action="PagarTarjeta" asp-route-id="@Model.Id" class="btn btn-primary">Pagar Tarjeta</a>
                    <a asp-controller="Avances" asp-action="Index" asp-route-tarjetaId="@Model.Id" class="btn btn-secondary">Avance de Efectivo</a>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <h5>Información de la Tarjeta</h5>
            <div class="card">
                <div class="card-body">
                    <p><strong>Utilización:</strong></p>
                    @{
                        decimal utilizacion = Model.CreditLimit > 0 ? (Model.CurrentDebt / Model.CreditLimit) : 0;
                        string colorClass = utilizacion > 0.8m ? "danger" : utilizacion > 0.5m ? "warning" : "success";
                    }
                    <div class="progress" role="progressbar" aria-valuenow="@((int)(utilizacion * 100))" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar bg-@colorClass" style="width: @(utilizacion * 100)%">
                            @(utilizacion * 100).ToString("F1")%
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">Volver</a>
    </div>
</div>
